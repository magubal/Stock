# Feature Plan: Crypto Trends Monitor (크립토 동향 모니터)

## 1. Overview
- **Feature Name**: crypto-trends-monitor
- **Level**: Dynamic (API + 정적 HTML + Dashboard 연동)
- **Priority**: High
- **Estimated Scope**: Dashboard 링크 + 전용 모니터 페이지 + 외부 API 연동 + 변화 감지 엔진

## 2. Background & Motivation

### 2.1 존재 이유
크립토 시장은 주식 시장과의 전이(contagion) 경로가 뚜렷해지고 있다.
사용자는 매일 4개 이상의 외부 사이트를 직접 순회하며 크립토 동향을 파악하는데,
**비효율적이고 변화 감지가 늦다.**

이 페이지는 "뉴스처럼 길게 읽는 것"이 아니라,
**변화 감지(Δ) + 레짐 판정 + 클릭 유도**를 통해 10초 안에 판단을 내릴 수 있게 한다.

### 2.2 사용자가 내려야 하는 결정 3가지

| # | 결정 | 핵심 질문 |
|---|------|-----------|
| D1 | **전이 여부** | 지금 크립토가 리스크온/오프로 주식에 영향을 주는가? |
| D2 | **주도권** | BTC/ETH 중 어디가 주도권을 갖는가? (도미넌스/흐름) |
| D3 | **레짐 변화** | '가격 변동'이 아니라 '유동성/수급/밸류에이션 레짐'이 바뀌었는가? |

### 2.3 핵심 원칙: "가격이 아니라 본질 변화를 잡는다"
- 유동성(Stablecoin Supply)
- 도미넌스(BTC.D / ETH.D)
- 기관 수급(ETH ETF Flow)
- 온체인 밸류에이션(MVRV Z-Score)
- 거래량 확산(Volume vs 평균)

## 3. UX 원칙 (빠른 판단을 강제하는 구조)

| 원칙 | 설명 |
|------|------|
| **A. 1스크린 완결** | 스크롤 없이 오늘의 핵심 상태와 링크별 중요도가 보여야 함 |
| **B. 클릭은 '검증/심화'** | 요약에서 이미 "왜 중요한지"가 끝나 있어야 함. 클릭은 자세히 보러 가는 동작 |
| **C. 중요도는 시스템이 먼저 매긴다** | 사용자는 "어디를 볼지" 결정만 하면 됨 |

## 4. 페이지 정보구조

### 4.1 상단: "Crypto Pulse" 요약 바

#### 한 줄 결론 (자동 생성)
> 예: `[추정] "ETF 흐름은 중립인데 스테이블코인이 늘어 '유동성 기반 리스크온' 가능성"`

#### 계기판 7개 (핵심 지표)
| # | 지표 | 표시 형식 | 투자 의미 |
|---|------|-----------|-----------|
| G1 | Total Crypto Market Cap | 값 + 1D Δ% + 7D Δ% | 시장 규모 변화 |
| G2 | 24h Volume | 값 + vs 7D 평균 배수 | 거래 활성도 |
| G3 | BTC Dominance | 값% + 7D Δ(pp) | BTC 쏠림/확산 |
| G4 | ETH/BTC 또는 ETH Dominance | 값 + 7D Δ(pp) | ETH 주도권 |
| G5 | ETH ETF Net Flow | 1D + 5D 누적 | 기관 수급 방향 |
| G6 | MVRV Z-Score | 값 + 레짐 라벨 | BTC 사이클 위치 |
| G7 | Stablecoin Supply | 값 + 7D Δ% + 체인 점유 변화 | 유동성 대기자금 |

### 4.2 중단: 소스별 상세 카드 4개 (각 10초 판단)

#### 카드 공통 컴포넌트
```
┌─ [HIGH/MID/LOW 배지] ── 카드 제목 ─────────────┐
│                                                    │
│  📊 변화 3줄 요약 (무엇이 바뀌었나, Δ 중심)      │
│  [확인] 관측치 (숫자/방향/Δ)                      │
│  [추정] 의미 (레짐/전이/수급 해석)                │
│  [추정] 행동 제안 (클릭할지/대기할지)             │
│                                                    │
│               [🔗 새 창에서 자세히 보기 →]         │
└────────────────────────────────────────────────────┘
```

#### 카드 A: Crypto Overview (시장 전체 온도)
- **URL**: https://coinmarketcap.com/charts/
- **답해야 하는 질문**: 오늘 시장이 "상승/하락"이 아니라 **위험선호가 붙었는지**(거래량/확산)
- **핵심 항목**:
  - Market Cap: 1D/7D Δ
  - 24h Volume: 24h / 7D 평균 (배수)
  - BTC.D / ETH.D: 7D Δ(pp)
  - Top movers 상위 상승/하락: "확산/쏠림" 판단용
- **중요도 트리거**:
  - Market Cap 1D 변동 ±3% 이상
  - Volume이 7D 평균 대비 1.5배 이상
  - BTC.D가 7D에 ±0.7pp 이상 이동
  - → 1개 충족 시 MID, 2개 이상 HIGH

#### 카드 B: Ethereum ETF (기관 수급)
- **URL**: https://coinmarketcap.com/etf/ethereum/
- **답해야 하는 질문**: **ETH 쪽으로 기관성 수급이 들어오고 있나?** (연속성/규모)
- **핵심 항목**:
  - Net Flow(1D, 5D 누적/연속성)
  - AUM 변화(주간)
  - Flow-가격 디커플링 여부 (흐름↑가격↓ = 지연 반영?)
- **중요도 트리거**:
  - 5거래일 중 4일 이상 같은 방향 (유입/유출)
  - 1D net flow가 최근 20일 분포 상위 10%
  - [추정] 유입인데 ETH/BTC 약세면 "지연 반영/헤지" 가능성 코멘트
  - → 연속성+규모 둘 다 HIGH, 하나만이면 MID

#### 카드 C: Bitcoin MVRV Z-Score (사이클 위치)
- **URL**: https://www.bitcoinmagazinepro.com/charts/mvrv-zscore/
- **답해야 하는 질문**: BTC가 지금 **싸서 사는 구간인지, 비싸서 쫓는 구간인지** (레짐)
- **핵심 항목**:
  - 현재 Z-score 값 + 레짐 라벨
  - 레짐 구간: 저평가(< 0) / 축적(0~2) / 중립(2~3) / 과열 초입(3~5) / 과열(5~7) / 극단(> 7)
  - "레짐 전환" 여부 (임계구간 진입/이탈)
- **중요도 트리거**:
  - Z-score가 핵심 임계대(0, 1, 3, 7) 근처에서 상향/하향 돌파
  - **전환 발생 시 무조건 HIGH** (가격이 아니라 '사이클 신호')
  - 전환 없으면 LOW

#### 카드 D: Stablecoin 점유율 (유동성 흐름)
- **URL**: https://defillama.com/stablecoins/chains
- **답해야 하는 질문**: 시장에 **달러 유동성이 새로 들어오는가?** + **어느 체인으로 이동하는가?**
- **핵심 항목**:
  - Total stablecoin supply 7D Δ (증가/감소)
  - Chain share 변화 Top 2 (예: ETH↑ SOL↓)
  - ETH 체인의 스테이블 비중 변화
- **중요도 트리거**:
  - 7D stablecoin 총량이 의미 있게 증가 (상대 기준 상위 20%)
  - 체인 점유율이 7D에 1pp 이상 이동 (로테이션)
  - → 둘 다면 HIGH (유동성 체인지), 하나만 MID

### 4.3 하단(선택): "주식 전이 체크" 미니 블록

- **전이 경로 3가지** (추정):
  1. 크립토 → 나스닥 → 코스피 성장주
  2. 달러 → 스테이블코인 → 크립토
  3. ETF 수급 → 시장 유동성
- **체크박스**: "크립토 강세가 주식으로 번지는 조건 충족?" (확인/미확인)

## 5. 요약 생성 규칙

### 5.1 요약 포맷 (3줄 고정)
```
(1) [확인] 관측치 (숫자/방향/Δ)
(2) [추정] 의미 (레짐/전이/수급 해석)
(3) [추정] 행동 제안 (클릭할지/대기할지)
```

### 5.2 예시
```
[확인] "스테이블 총량 7D +2.3%, ETH 체인 점유율 +1.2pp"
[추정] "달러 유동성이 'ETH 쪽'으로 이동 → ETH/BTC 방어 가능성"
[추정] "ETH ETF 카드만 상세 클릭 권장 (원인 확인)"
```

### 5.3 핵심: "단순 요약"이 아니라 "변화 요약(Difference Summary)"
- 어제 대비 무엇이 달라졌는가
- 그 변화가 레짐 전환을 의미하는가
- 사용자가 무엇을 해야 하는가

## 6. 대시보드 연동 (index.html)

### 6.1 시장 모니터링 섹션 링크 추가
기존 "오늘의 공시", "유동성 및 신용 스트레스" 아래에 "크립토 동향" 추가

### 6.2 링크 표시 방식 (배지 포함)
```
┌─ 🟡 크립토 동향 ─────────────────────────────┐
│  유동성/ETF/온체인 레짐          HIGH 2 MID 1  │
└────────────────────────────────────────────────┘
```
- HIGH가 있으면 **빨간 점**, MID면 **노란 점**, LOW만이면 **회색**
- 오른쪽에 오늘 이슈 개수 표시 (HIGH n / MID n)

## 7. 데이터 소스 & API 전략

### 7.1 자동 수집 가능 (무료 API)
| 지표 | API | 비용 | 획득 데이터 |
|------|-----|------|-------------|
| Market Cap, Volume, BTC.D | CoinGecko `/global` | 무료 (30 calls/min) | 시가총액, 거래량, 도미넌스 |
| ETH/BTC | CoinGecko `/simple/price` | 무료 | ETH/BTC 비율 |
| Stablecoin Supply | DefiLlama `/stablecoins` | 무료 (무제한) | 총 공급량, 체인별 분포 |
| Fear & Greed | alternative.me API | 무료 | 공포/탐욕 지수 |

### 7.2 수동 입력 / 링크 참조 (무료 API 없음)
| 지표 | 이유 | 대안 |
|------|------|------|
| ETH ETF Net Flow | 공개 무료 API 없음 | 수동 입력 필드 + CoinMarketCap 링크 |
| MVRV Z-Score | 유료 API만 존재 | 수동 입력 필드 + BitcoinMagazinePro 링크 |

### 7.3 데이터 갱신 주기
- 자동 API: 페이지 로드 시
- 수동 입력: 사용자가 직접 업데이트 (localStorage 저장)
- Δ 계산: 7D 이동평균 대비 변화율

## 8. 중요도 자동 산정 엔진

### 8.1 트리거 기반 판정

각 카드별 트리거 조건 → 충족 개수에 따라 등급 결정:

```
충족 0개 → LOW (회색)
충족 1개 → MID (노란색)
충족 2개+ → HIGH (빨간색)
```

### 8.2 카드별 트리거 요약

| 카드 | 트리거 1 | 트리거 2 | 트리거 3 |
|------|----------|----------|----------|
| A. Overview | Mkt Cap 1D ±3% | Vol ≥ 7D avg × 1.5 | BTC.D 7D ±0.7pp |
| B. ETH ETF | 5일 중 4일 같은 방향 | 1D flow 상위 10% | Flow-가격 디커플링 |
| C. MVRV | 임계대 돌파 (무조건 HIGH) | - | - |
| D. Stablecoin | 총량 7D Δ 상위 20% | 체인 점유 7D ±1pp | - |

## 9. 기술 구현 계획

### 9.1 파일 구조
```
dashboard/
├── crypto_trends.html          # 전용 모니터 페이지 (정적 HTML + CDN React)
├── index.html                  # 시장 모니터링에 링크 추가 (수정)

backend/app/
├── api/crypto_trends.py        # API Router (향후 자동화 시)
├── services/crypto_service.py  # 데이터 수집/캐싱 서비스 (향후)

scripts/crypto_monitor/
├── fetch_coingecko.py          # CoinGecko API 수집
├── fetch_defillama.py          # DefiLlama API 수집
├── calc_triggers.py            # 트리거 계산 + 중요도 산정
```

### 9.2 구현 단계

#### MVP (Phase 1) — 즉시 사용 가능
| # | 항목 | 설명 | 우선순위 |
|---|------|------|----------|
| M1 | Dashboard 링크 | index.html 시장모니터링에 "크립토 동향" 추가 | Must |
| M2 | 모니터 페이지 | crypto_trends.html 기본 레이아웃 | Must |
| M3 | 4개 외부 링크 | 새 창 열기 버튼 (필수 URL 4개) | Must |
| M4 | 카드 UI | 4개 카드 + 중요도 배지(수동) + 요약 영역 | Must |
| M5 | 계기판 UI | 상단 7개 지표 게이지 (수동 입력 가능) | Must |
| M6 | 수동 입력 | 각 카드에 요약/지표 수동 입력 필드 (localStorage) | Should |

#### 자동화 1단계 (Phase 2)
| # | 항목 | 설명 | 우선순위 |
|---|------|------|----------|
| A1 | CoinGecko 연동 | Market Cap, Volume, BTC.D, ETH/BTC 자동 수집 | Must |
| A2 | DefiLlama 연동 | Stablecoin Supply, 체인별 분포 자동 수집 | Must |
| A3 | Fear & Greed | alternative.me API 연동 | Should |
| A4 | Δ 계산 | 어제/7D 대비 변화율 자동 계산 | Must |
| A5 | 트리거 엔진 | 중요도 자동 산정 (HIGH/MID/LOW) | Must |
| A6 | 한 줄 결론 | 템플릿 기반 자동 생성 | Should |

#### 자동화 2단계 (Phase 3, 확장)
| # | 항목 | 설명 | 우선순위 |
|---|------|------|----------|
| E1 | 이슈 히스토리 | 최근 30일 저장 → 오늘 변화의 z-score 판단 | Could |
| E2 | 알림 정교화 | 대시보드 배지에 실시간 카운트 반영 | Could |
| E3 | 주식 전이 체크 | 크립토↔나스닥 상관/디커플링 감지 | Could |
| E4 | Funding/OI/Liquidation | 레버리지 청산 구간 감지 | Could |
| E5 | ETH 체인 활동 분해 | 스테이블 증가가 실사용인지 대기자금인지 | Could |

## 10. 성공 기준

| # | 기준 | 측정 방법 |
|---|------|-----------|
| SC-1 | 대시보드에서 크립토 동향 링크 클릭 → 페이지 정상 표시 | 수동 확인 |
| SC-2 | 4개 외부 링크 모두 새 창으로 정상 열림 | 수동 확인 |
| SC-3 | 1스크린 안에 계기판 + 4카드 모두 표시 | 1920×1080 기준 |
| SC-4 | 중요도 배지(HIGH/MID/LOW) 정상 표시 | 수동 확인 |
| SC-5 | (Phase 2) API 데이터 자동 갱신 + Δ 계산 정상 | API 호출 확인 |
| SC-6 | (Phase 2) 트리거 기반 중요도 자동 산정 | 테스트 시나리오 |

## 11. 확장 리서치 제안 (본질 관점)

현재 4개 링크만으로도 "유동성/레짐/수급"의 뼈대는 잡힌다.
해상도를 올리려면:

| 제안 | 설명 | 효과 |
|------|------|------|
| Funding/OI/Liquidation 대시 | 레버리지 청산 → 반등 구간 감지 | 단기 타이밍 |
| ETH 체인 활동 지표 | 스테이블 증가가 실사용/DeFi인지 대기자금인지 분해 | 유동성 질 판단 |
| 크립토↔나스닥 상관/디커플링 | 주식 전이 판단 정확도 상승 | 전이 신호 강화 |